<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Data preparation, processing and interpretation with R</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="This is the complementary manual for QFAB’s Data preparation, processing and interpretation with R">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="Data preparation, processing and interpretation with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the complementary manual for QFAB’s Data preparation, processing and interpretation with R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Data preparation, processing and interpretation with R" />
  
  <meta name="twitter:description" content="This is the complementary manual for QFAB’s Data preparation, processing and interpretation with R" />
  

<meta name="author" content="QFAB">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="data-manipulation-extracting-and-exporting-records.html">
<link rel="next" href="charts-and-graphical-output.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data processing, quality checking & interpretation with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="how-to-read-this-book.html"><a href="how-to-read-this-book.html"><i class="fa fa-check"></i><b>1.1</b> How to read this book</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1.2</b> Getting started</a></li>
<li class="chapter" data-level="1.3" data-path="a-quick-refresher.html"><a href="a-quick-refresher.html"><i class="fa fa-check"></i><b>1.3</b> A quick refresher</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-preparation.html"><a href="data-preparation.html"><i class="fa fa-check"></i><b>2</b> Data Preparation</a><ul>
<li class="chapter" data-level="2.1" data-path="data-lifecycle-management-plan.html"><a href="data-lifecycle-management-plan.html"><i class="fa fa-check"></i><b>2.1</b> Data Lifecycle &amp; Management Plan</a></li>
<li class="chapter" data-level="2.2" data-path="good-data-protocol.html"><a href="good-data-protocol.html"><i class="fa fa-check"></i><b>2.2</b> Good Data Protocol</a></li>
<li class="chapter" data-level="2.3" data-path="further-reading.html"><a href="further-reading.html"><i class="fa fa-check"></i><b>2.3</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="reproducible-reporting-in-r.html"><a href="reproducible-reporting-in-r.html"><i class="fa fa-check"></i><b>3</b> Reproducible reporting in R</a><ul>
<li class="chapter" data-level="3.1" data-path="literate-programming.html"><a href="literate-programming.html"><i class="fa fa-check"></i><b>3.1</b> Literate programming</a></li>
<li class="chapter" data-level="3.2" data-path="open-a-new-knitr-document.html"><a href="open-a-new-knitr-document.html"><i class="fa fa-check"></i><b>3.2</b> Open a new knitR document</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="importing-and-reformatting-data-files.html"><a href="importing-and-reformatting-data-files.html"><i class="fa fa-check"></i><b>4</b> Importing and reformatting data files</a><ul>
<li class="chapter" data-level="4.1" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>4.1</b> Importing data</a></li>
<li class="chapter" data-level="4.2" data-path="reformat-the-file.html"><a href="reformat-the-file.html"><i class="fa fa-check"></i><b>4.2</b> Reformat the file</a></li>
<li class="chapter" data-level="4.3" data-path="transform-data.html"><a href="transform-data.html"><i class="fa fa-check"></i><b>4.3</b> Transform data</a></li>
<li class="chapter" data-level="4.4" data-path="normalise-data.html"><a href="normalise-data.html"><i class="fa fa-check"></i><b>4.4</b> Normalise data</a></li>
<li class="chapter" data-level="4.5" data-path="export-data.html"><a href="export-data.html"><i class="fa fa-check"></i><b>4.5</b> Export data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-manipulation-extracting-and-exporting-records.html"><a href="data-manipulation-extracting-and-exporting-records.html"><i class="fa fa-check"></i><b>5</b> Data manipulation - extracting and exporting records</a><ul>
<li class="chapter" data-level="5.1" data-path="extracting-records.html"><a href="extracting-records.html"><i class="fa fa-check"></i><b>5.1</b> Extracting records</a><ul>
<li class="chapter" data-level="5.1.1" data-path="extracting-records.html"><a href="extracting-records.html#removing-samples"><i class="fa fa-check"></i><b>5.1.1</b> Removing samples</a></li>
<li class="chapter" data-level="5.1.2" data-path="extracting-records.html"><a href="extracting-records.html#remove-uninformative-measurements"><i class="fa fa-check"></i><b>5.1.2</b> Remove uninformative measurements</a></li>
<li class="chapter" data-level="5.1.3" data-path="extracting-records.html"><a href="extracting-records.html#extracting-specific-measurements"><i class="fa fa-check"></i><b>5.1.3</b> Extracting specific measurements</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="charts-and-graphical-output.html"><a href="charts-and-graphical-output.html"><i class="fa fa-check"></i><b>6</b> Charts and graphical output</a><ul>
<li class="chapter" data-level="6.1" data-path="standard-r-plotting-functions.html"><a href="standard-r-plotting-functions.html"><i class="fa fa-check"></i><b>6.1</b> Standard R plotting functions</a><ul>
<li class="chapter" data-level="6.1.1" data-path="standard-r-plotting-functions.html"><a href="standard-r-plotting-functions.html#distribution-plots"><i class="fa fa-check"></i><b>6.1.1</b> Distribution plots</a></li>
<li class="chapter" data-level="6.1.2" data-path="standard-r-plotting-functions.html"><a href="standard-r-plotting-functions.html#heatmaps"><i class="fa fa-check"></i><b>6.1.2</b> Heatmaps</a></li>
<li class="chapter" data-level="6.1.3" data-path="standard-r-plotting-functions.html"><a href="standard-r-plotting-functions.html#pca-plots"><i class="fa fa-check"></i><b>6.1.3</b> PCA plots</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>6.2</b> ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="generating-report-with-r.html"><a href="generating-report-with-r.html"><i class="fa fa-check"></i><b>7</b> Generating report with R</a><ul>
<li class="chapter" data-level="7.1" data-path="other-reporting-formats.html"><a href="other-reporting-formats.html"><i class="fa fa-check"></i><b>7.1</b> Other reporting formats</a></li>
<li class="chapter" data-level="7.2" data-path="interactive-reporting-with-shiny.html"><a href="interactive-reporting-with-shiny.html"><i class="fa fa-check"></i><b>7.2</b> Interactive reporting with Shiny</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>8</b> Conclusion</a></li>
<li class="chapter" data-level="" data-path="appendix-exercise-answers.html"><a href="appendix-exercise-answers.html"><i class="fa fa-check"></i>Appendix: Exercise answers</a><ul>
<li class="chapter" data-level="" data-path="importing-and-reformatting-data-files-1.html"><a href="importing-and-reformatting-data-files-1.html"><i class="fa fa-check"></i>4 Importing and reformatting data files</a><ul>
<li class="chapter" data-level="" data-path="importing-and-reformatting-data-files-1.html"><a href="importing-and-reformatting-data-files-1.html#read-in-the-datafile"><i class="fa fa-check"></i>4.1 Read in the datafile</a></li>
<li class="chapter" data-level="" data-path="importing-and-reformatting-data-files-1.html"><a href="importing-and-reformatting-data-files-1.html#reformat-the-file-1"><i class="fa fa-check"></i>4.2 Reformat the file</a></li>
<li class="chapter" data-level="" data-path="importing-and-reformatting-data-files-1.html"><a href="importing-and-reformatting-data-files-1.html#transform-data-1"><i class="fa fa-check"></i>4.3 Transform data</a></li>
<li class="chapter" data-level="" data-path="importing-and-reformatting-data-files-1.html"><a href="importing-and-reformatting-data-files-1.html#normalise-data-1"><i class="fa fa-check"></i>4.4 Normalise data</a></li>
<li class="chapter" data-level="" data-path="importing-and-reformatting-data-files-1.html"><a href="importing-and-reformatting-data-files-1.html#export-data-1"><i class="fa fa-check"></i>4.5 Export data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-manipulation.html"><a href="data-manipulation.html"><i class="fa fa-check"></i>5.1 Data manipulation</a><ul>
<li class="chapter" data-level="" data-path="data-manipulation.html"><a href="data-manipulation.html#removing-samples-1"><i class="fa fa-check"></i>5.1.2 Removing samples</a></li>
<li class="chapter" data-level="" data-path="data-manipulation.html"><a href="data-manipulation.html#remove-uninformative-measurements-1"><i class="fa fa-check"></i>5.1.2 Remove uninformative measurements</a></li>
<li class="chapter" data-level="" data-path="data-manipulation.html"><a href="data-manipulation.html#extracting-specific-measurements-1"><i class="fa fa-check"></i>5.1.3 Extracting specific measurements</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="charts-and-graphical-output-1.html"><a href="charts-and-graphical-output-1.html"><i class="fa fa-check"></i>6 Charts and graphical output</a><ul>
<li class="chapter" data-level="" data-path="charts-and-graphical-output-1.html"><a href="charts-and-graphical-output-1.html#plot"><i class="fa fa-check"></i>Plot</a></li>
<li class="chapter" data-level="" data-path="charts-and-graphical-output-1.html"><a href="charts-and-graphical-output-1.html#heatmaps-1"><i class="fa fa-check"></i>Heatmaps</a></li>
<li class="chapter" data-level="" data-path="charts-and-graphical-output-1.html"><a href="charts-and-graphical-output-1.html#pca-plots-1"><i class="fa fa-check"></i>PCA plots</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ggplot2-1.html"><a href="ggplot2-1.html"><i class="fa fa-check"></i>6.2 ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-sessioninfo-for-this-version-of-the-course-material.html"><a href="appendix-sessioninfo-for-this-version-of-the-course-material.html"><i class="fa fa-check"></i>Appendix - SessionInfo for this version of the course material</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data preparation, processing and interpretation with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="extracting-records" class="section level2">
<h2><span class="header-section-number">5.1</span> Extracting records</h2>
<div id="removing-samples" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Removing samples</h3>
<p>Our statistical colleagues have now performed some tests on the Golub data, and have warned us that there are some outliers in the dataset. These are characterised by low or high mean intensity values, and large or small standard deviations. Being statisticians who like a joke though, they haven’t told us which samples are affected. To be careful, we will remove the eight most extreme samples, two with the highest and two with the lowest mean intensity, and likewise two each with the highest and lowest standard deviation</p>
<div class="rmdtip">
<p>
Some functions that you might find useful in this exercise are <code>apply</code>, <code>colMeans</code>, <code>order</code>, <code>which.min</code> and <code>which.max</code>.
</p>
</div>
<div class="rmdexercise">
<p>
Using the full Golub matrix (before log transforming and normalisation), identify and remove:
</p>
<ol style="list-style-type: lower-alpha">
<li>
The two samples with the highest mean
</li>
<li>
The two samples with the lowest mean
</li>
<li>
The two samples with the highest standard deviation
</li>
<li>
The two samples with the lowest standard deviation
</li>
</ol>
<p>
<strong>Warning</strong>: When performing such data transformations, becareful about how you are performing the steps.
</p>
<ol style="list-style-type: decimal">
<li>
Do you perform each filtration one after the other? That is, filter (a) then filter (b) then filter (c) and then filter (d).
</li>
</ol>
<p>
or
</p>
<ol start="2" style="list-style-type: decimal">
<li>
Do you first find the answers to (a), (b), (c) and (d) first before performing the filtration in one go?
</li>
</ol>
<p>
Try both approaches above and compare your results. <em>Hint</em>: After each step (a) to (d) look at which sample has the two highest or lowest mean and standard deviation.
</p>
</div>
</div>
<div id="remove-uninformative-measurements" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Remove uninformative measurements</h3>
<p>The Golub dataset that we have been using so far contains around 7,000 measurements (gene intensities). Much of this data may be redundant or uninformative, so in this section we will explore ways of filtering out low-value information from a dataset.</p>
<p>During our transformation stage, we applied a floor and ceiling value to our measurements, because values outside of this range are considered unreliable. If all the measurements for a gene were below the floor value, or above the ceiling, we can conclude that the expression value of that gene is uniformly outside the useful range of measurement, and ignore the data for that gene. Also, since this is a differential expression analysis, we are not interested in genes which show low levels of variability across the samples, so we will remove them too.</p>
<div class="rmdexercise">
<ol style="list-style-type: decimal">
<li>
<p>
Use the <code>apply()</code> function to generate a new matrix which excludes all genes with an intensity of 100 or less across all samples (use the dataset from which you have removed the outliers).
</p>
<p>
<em>Hint</em>: break the problem down first, find the maximum intensity for each gene, then identify for which genes that maximum is more than 100, then finally slice just those rows to a new matrix
</p>
</li>
<li>
<p>
Further filter this new matrix to remove all genes with an intensity of 16,000 or more for all samples
</p>
</li>
<li>
<p>
Finally, filter the matrix once more to remove all genes with less than a five-fold change in signal across the samples
</p>
</li>
</ol>
</div>
</div>
<div id="extracting-specific-measurements" class="section level3">
<h3><span class="header-section-number">5.1.3</span> Extracting specific measurements</h3>
<p>To make up for their practical joke earlier, our statistician friends have now come back and provided us with a list of the one hundred genes that their analysis tells them are most important in differentiating between the <span class="math inline">\(ALL\)</span> and <span class="math inline">\(AML\)</span> groups in our experiment. They’ve also admitted that there weren’t really any outliers after all. To study these further, we therefore want to retrieve the log transformed and normalised intensity values of just these one hundred probes for all 38 of our original samples.</p>
<div class="rmdexercise">
<ol style="list-style-type: decimal">
<li>
<p>
Read in the list of 100 probe IDs and associated gene names from the data file <strong>“golub100.txt”</strong>
</p>
<p>
<em>Hint</em>: the gene names are in column 2 of this tab-delimited file, the probe IDs in column 1
</p>
</li>
<li>
<p>
Generate a new matrix of log normalised values for all 38 samples and the 100 genes in this list
</p>
</li>
</ol>
</div>
<p>We will now try further practice on an alternative input dataset. Before doing this, it would again be worth saving your R workspace and your markdown code. Perhaps open a new markdown document for this second dataset</p>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="data-manipulation-extracting-and-exporting-records.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="charts-and-graphical-output.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["data-proc-qc-inter.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
